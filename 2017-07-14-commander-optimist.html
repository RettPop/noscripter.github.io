<!DOCTYPE html>
<html lang="en" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Language" content="en">
  <style>
@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

html {
    font-family: sans-serif;
    -ms-text-size-adjust: 100%;
    -webkit-text-size-adjust: 100%
}

body {
    min-width: 1020px;
    font: 13px/1.4 Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
    /* color: #333; */
    background-color: #fff;
}

table {
    border-collapse: collapse;
    border-spacing: 0
}

td,th {
    padding: 0
}

* {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

.container {
    /* modified by leo */
    /*width: 980px;*/
    margin-right: auto;
    margin-left: auto
}

.container:before {
    display: table;
    content: ""
}

.container:after {
    display: table;
    clear: both;
    content: ""
}

.boxed-group {
    position: relative;
    border-radius: 3px;
    margin-bottom: 30px
}

#readme .markdown-body, #readme .plain {
    background-color: #fff;
    border: 1px solid #ddd;
    border-bottom-left-radius: 3px;
    border-bottom-right-radius: 3px;
    padding: 30px;
    word-wrap: break-word;
}

#readme .plain pre {
    font-size: 15px;
    white-space: pre-wrap
}

.repository-with-sidebar:before {
    display: table;
    content: ""
}

.repository-with-sidebar:after {
    display: table;
    clear: both;
    content: ""
}

.repository-with-sidebar .repository-sidebar {
    float: right;
    width: 38px
}

.repository-with-sidebar .repository-sidebar .sidebar-button {
    width: 100%;
    margin: 0 0 10px;
    text-align: center
}

.repository-with-sidebar .repository-sidebar h3 {
    margin-bottom: 5px;
    font-size: 11px;
    font-weight: normal;
    color: #999
}

.repository-with-sidebar .repository-sidebar .clone-url {
    display: none;
    margin-top: -5px
}

.repository-with-sidebar .repository-sidebar .clone-url.open {
    display: block
}

.repository-with-sidebar .repository-sidebar .clone-options {
    margin: 8px 0 15px;
    font-size: 11px;
    color: #666
}

.repository-with-sidebar .repository-sidebar .clone-options .octicon-question {
    position: relative;
    bottom: 1px;
    font-size: 11px;
    color: #000;
    cursor: pointer
}

.repository-with-sidebar .repository-content {
    /* float: left; */
    /* modified by leo */
    /*width: 920px;*/
}

.repository-with-sidebar.with-full-navigation .repository-content {
    /* modified by leo */
    /*width: 790px;*/
}

.repository-with-sidebar.with-full-navigation .repository-sidebar {
    width: 170px
}

.repository-with-sidebar.with-full-navigation .sunken-menu-group .tooltipped:before, .repository-with-sidebar.with-full-navigation .sunken-menu-group .tooltipped:after {
    display: none
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body strong {
  font-weight: bold;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px/1.4 Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before {
  display: table;
  content: "";
}

.markdown-body hr:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code {
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body .octicon {
  font: normal normal 16px octicons-anchor;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.markdown-body .octicon-link:before {
  content: '\f05c';
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .anchor {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  display: none;
  color: #000;
  vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  padding-left: 8px;
  margin-left: -30px;
  line-height: 1;
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  display: inline-block;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

.markdown-body .pl-c {
  color: #969896;
}

.markdown-body .pl-c1,
.markdown-body .pl-mdh,
.markdown-body .pl-mm,
.markdown-body .pl-mp,
.markdown-body .pl-mr,
.markdown-body .pl-s1 .pl-v,
.markdown-body .pl-s3,
.markdown-body .pl-sc,
.markdown-body .pl-sv {
  color: #0086b3;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #795da3;
}

.markdown-body .pl-s1 .pl-s2,
.markdown-body .pl-smi,
.markdown-body .pl-smp,
.markdown-body .pl-stj,
.markdown-body .pl-vo,
.markdown-body .pl-vpf {
  color: #333;
}

.markdown-body .pl-ent {
  color: #63a35c;
}

.markdown-body .pl-k,
.markdown-body .pl-s,
.markdown-body .pl-st {
  color: #a71d5d;
}

.markdown-body .pl-pds,
.markdown-body .pl-s1,
.markdown-body .pl-s1 .pl-pse .pl-s2,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre,
.markdown-body .pl-src,
.markdown-body .pl-v {
  color: #df5000;
}

.markdown-body .pl-id {
  color: #b52a1d;
}

.markdown-body .pl-ii {
  background-color: #b52a1d;
  color: #f8f8f8;
}

.markdown-body .pl-sr .pl-cce {
  color: #63a35c;
  font-weight: bold;
}

.markdown-body .pl-ml {
  color: #693a17;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #1d3e81;
  font-weight: bold;
}

.markdown-body .pl-mq {
  color: #008080;
}

.markdown-body .pl-mi {
  color: #333;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #333;
  font-weight: bold;
}

.markdown-body .pl-md,
.markdown-body .pl-mdhf {
  background-color: #ffecec;
  color: #bd2c00;
}

.markdown-body .pl-mdht,
.markdown-body .pl-mi1 {
  background-color: #eaffea;
  color: #55a532;
}

.markdown-body .pl-mdr {
  color: #795da3;
  font-weight: bold;
}

.markdown-body .pl-mo {
  color: #1d3e81;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  display: inline-block;
  padding: 3px 5px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  line-height: 10px;
  color: #000;
  border: 1px solid #cfcfcf;
  border-radius: 2px;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  float: left;
  margin: 0.3em 0 0.25em -1.6em;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  z-index: 1;
  position: relative;
  border-color: #4183c4;
}

/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
  -webkit-text-size-adjust: none;
}

.hljs-comment,
.diff .hljs-header,
.hljs-javadoc {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.css .rule .hljs-keyword,
.hljs-winutils,
.nginx .hljs-title,
.hljs-subst,
.hljs-request,
.hljs-status {
  color: #a71d5d;
}

.hljs-number,
.hljs-hexcolor,
.ruby .hljs-constant {
  color: #0086b3;
}

.hljs-string,
.hljs-tag .hljs-value,
.hljs-phpdoc,
.hljs-dartdoc,
.tex .hljs-formula {
  color: #df5000;
}

.hljs-title,
.hljs-id,
.scss .hljs-preprocessor {
  color: #900;
}

.hljs-list .hljs-keyword,
.hljs-subst {
  font-weight: normal;
}

.hljs-class .hljs-title,
.hljs-type,
.vhdl .hljs-literal,
.tex .hljs-command {
  color: #795da3;
}

.hljs-tag,
.hljs-tag .hljs-title,
.hljs-rules .hljs-property,
.django .hljs-tag .hljs-keyword {
  color: #000080;
  font-weight: normal;
}

.hljs-attribute,
.hljs-variable,
.lisp .hljs-body {
  color: #008080;
}

.hljs-regexp {
  color: #009926;
}

.hljs-symbol,
.ruby .hljs-symbol .hljs-string,
.lisp .hljs-keyword,
.clojure .hljs-keyword,
.scheme .hljs-keyword,
.tex .hljs-special,
.hljs-prompt {
  color: #990073;
}

.hljs-built_in {
  color: #795da3;
}

.hljs-preprocessor,
.hljs-pragma,
.hljs-pi,
.hljs-doctype,
.hljs-shebang,
.hljs-cdata {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.diff .hljs-change {
  background: #0086b3;
}

.hljs-chunk {
  color: #aaa;
}
  </style>
  <style>
    .markdown-body {
      min-width: 200px;
      margin: 0 auto;
      padding: 30px;
    }
  </style>
<link rel="stylesheet" type="text/css" href="chrome-extension://pkehgijcmpdhfbdbbnkijodmdjhbjlgp/skin/socialwidgets/socialwidgets.css"></head>
<body>
  <div class="wrapper">
    <div class="container">
      <div class="repository-with-sidebar repo-container new-discussion-timeline with-full-navigation">
        <div id="js-repo-pjax-container" class="repository-content context-loader-container">
          <div id="readme" class="boxed-group flush clearfix announce instapaper_body md">
            <article class="markdown-body"><h2>Node.js 学习之——commander+optimist+yargs</h2>
<h3>commander</h3>
<ul>
<li><a href="https://github.com/tj/commander.js.git">源代码地址</a></li>
<li><a href="https://www.npmjs.com/package/commander">npm 模块地址</a></li>
<li>作者： tj 大神</li>
<li>Stats
<ul>
<li>1,431,241 downloads in the last day</li>
<li>7,793,081 downloads in the last week</li>
<li>31,520,085 downloads in the last month</li>
<li>159 open issues on GitHub</li>
<li>35 open pull requests on GitHub</li>
</ul>
</li>
<li>依赖：无</li>
</ul>
<p>用到的原生模块：</p>
<ul>
<li><a href="https://nodejs.org/dist/latest-v8.x/docs/api/events.html">events</a></li>
<li><a href="https://nodejs.org/dist/latest-v8.x/docs/api/child_process.html">child_process</a></li>
<li><a href="https://nodejs.org/dist/latest-v8.x/docs/api/path.html">path</a></li>
<li><a href="https://nodejs.org/dist/latest-v8.x/docs/api/fs.html">fs</a></li>
</ul>
<p>默认暴露的是一个<code>Command</code>类的实例。</p>
<pre><code class="language-javascript">exports = <span class="hljs-keyword">new</span> Command();
<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">new</span> Command();
</code></pre>
<p>简写为：</p>
<pre><code class="language-javascript">exports = <span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">new</span> Command();
</code></pre>
<p>这个模块还暴露了两个函数：<code>Option</code>和<code>Command</code>。</p>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * 使用指定的`flags`和`description`初始化一个新的`Option`
 * @param {String} flags
 * @param {String} description
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Option</span>(<span class="hljs-params">flags, description</span>) </span>{
  <span class="hljs-keyword">this</span>.flags = flags;
  <span class="hljs-keyword">this</span>.required = ~flags.indexOf(<span class="hljs-string">'&lt;'</span>);
  <span class="hljs-keyword">this</span>.optional = ~flags.indexOf(<span class="hljs-string">'['</span>);
  <span class="hljs-keyword">this</span>.bool = !~flags.indexOf(<span class="hljs-string">'-no-'</span>);
  flags = flags.split(<span class="hljs-regexp">/[ ,|]+/</span>);
}

Option.prototype.name = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.long
    .replace(<span class="hljs-string">'--'</span>, <span class="hljs-string">''</span>)
    .replace(<span class="hljs-string">'no-'</span>, <span class="hljs-string">''</span>);
};

Option.prototype.is = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) </span>{
  <span class="hljs-keyword">return</span> arg == <span class="hljs-keyword">this</span>.short || arg == <span class="hljs-keyword">this</span>.long;
};
</code></pre>
<p><code>Command</code>函数：</p>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Node.js 学习之——commander+optimist+yargs</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.commands = [];
  <span class="hljs-keyword">this</span>.options = [];
  <span class="hljs-keyword">this</span>._execs = {};
  <span class="hljs-keyword">this</span>._allowUnknownOption = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">this</span>._args = [];
  <span class="hljs-keyword">this</span>._name = name || <span class="hljs-string">''</span>;
}

Command.prototype.__proto__ = EventEmitter.prototype;
</code></pre>
<blockquote>
<p>JavaScript 知识点：</p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split">String.split 方法支持使用正则表达式</a></p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_NOT">JavaScript 按位操作符：<code>~</code></a></p>
<p><code>Bitwise NOTing any number x yields -(x + 1). For example, ~5 yields -6.</code></p>
</blockquote>
<p>几个关键方法：</p>
<ul>
<li><code>executeSubCommand</code>：通过调用<code>child_process</code>模块的<code>spawn</code>方法实现。
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> proc;
<span class="hljs-keyword">if</span> (process.platform !== <span class="hljs-string">'win32'</span>) {
  <span class="hljs-keyword">if</span> (isExplicitJS) {
    args.unshift(bin);
    <span class="hljs-comment">// add executable arguments to spawn</span>
    args = (process.execArgv || []).concat(args);

    proc = spawn(process.argv[<span class="hljs-number">0</span>], args, { stdio: <span class="hljs-string">'inherit'</span>, customFds: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>] });
  } <span class="hljs-keyword">else</span> {
    proc = spawn(bin, args, { stdio: <span class="hljs-string">'inherit'</span>, customFds: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>] });
  }
} <span class="hljs-keyword">else</span> {
  args.unshift(bin);
  proc = spawn(process.execPath, args, { stdio: <span class="hljs-string">'inherit'</span>});
}

<span class="hljs-keyword">var</span> signals = [<span class="hljs-string">'SIGUSR1'</span>, <span class="hljs-string">'SIGUSR2'</span>, <span class="hljs-string">'SIGTERM'</span>, <span class="hljs-string">'SIGINT'</span>, <span class="hljs-string">'SIGHUP'</span>];
signals.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">signal</span>) </span>{
  process.on(signal, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span> ((proc.killed === <span class="hljs-literal">false</span>) &amp;&amp; (proc.exitCode === <span class="hljs-literal">null</span>)){
      proc.kill(signal);
    }
  });
});
proc.on(<span class="hljs-string">'close'</span>, process.exit.bind(process));
proc.on(<span class="hljs-string">'error'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
  <span class="hljs-keyword">if</span> (err.code == <span class="hljs-string">"ENOENT"</span>) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'\n  %s(1) does not exist, try --help\n'</span>, bin);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (err.code == <span class="hljs-string">"EACCES"</span>) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'\n  %s(1) not executable. try chmod or run with root\n'</span>, bin);
  }
  process.exit(<span class="hljs-number">1</span>);
});
</code></pre>
</li>
<li><code>action</code>：通过继承<code>events</code>模块的<a href="https://nodejs.org/dist/latest-v8.x/docs/api/events.html#events_emitter_on_eventname_listener">EventEmitter 类</a>来实现对自定义命令的监听。
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> name = parent === <span class="hljs-keyword">this</span> ? <span class="hljs-string">'*'</span> : <span class="hljs-keyword">this</span>._name;
parent.on(<span class="hljs-string">'command:'</span> + name, listener);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._alias) parent.on(<span class="hljs-string">'command:'</span> + <span class="hljs-keyword">this</span>._alias, listener);
<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
</code></pre>
</li>
</ul>
<p>测试方式：采用<a href="https://www.gnu.org/software/make/manual/make.html">makefile</a>来测试，实际上是通过<a href="https://www.npmjs.com/package/should">should 断言库</a>和 node.js 脚本来直接比较输出结果是否符合预期。</p>
<blockquote>
<p>可以考虑提 MR 将测试脚本改成比较先进的 mocha
测试，还可以顺便看看代码测试覆盖率。</p>
</blockquote>
<pre><code class="language-make"># 找到项目下的所有测试脚本
TESTS = $(shell find test/test.*.js)

# 通过 ./test/run 脚本来运行测试脚本
test:
    @./test/run $(TESTS)

.PHONY: test
</code></pre>
<p><code>example</code>目录下方了很多模块使用例子，便于快速上手使用。👍</p>
<h3>optimist</h3>
<ul>
<li><a href="http://github.com/substack/node-optimist.git">源代码地址</a></li>
<li><a href="https://www.npmjs.com/package/optimist">npm 模块地址</a></li>
<li>作者：substack 大神（运行<code>npm substack</code>试试）</li>
<li>Stats(20170715)
<ul>
<li>621,305 downloads in the last day</li>
<li>3,316,478 downloads in the last week</li>
<li>13,836,551 downloads in the last month</li>
<li>5 open issues on GitHub</li>
<li>6 open pull requests on GitHub</li>
</ul>
</li>
<li>依赖：
<ul>
<li><a href="https://www.npmjs.com/package/wordwrap">wordwrap</a>
<ul>
<li><a href="https://github.com/substack/node-wordwrap">github</a></li>
</ul>
</li>
<li><a href="https://www.npmjs.com/package/minimist">minimist</a>
<ul>
<li><a href="https://github.com/substack/minimist">github</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>然而作者已不打算维护，并绝对废弃（deprecate） 掉这个仓库了。</p>
<p>作者推荐直接使用<a href="http://localhost:8090/">minimist 模块</a>或者换成<a href="http://localhost:8090/">yargs</a>。</p>
<h3>minimist</h3>
<ul>
<li><a href="https://github.com/substack/minimist">代码地址</a></li>
<li><a href="https://www.npmjs.com/package/minimist">npm 模块地址</a></li>
<li>stat
<ul>
<li>1,829,743 downloads in the last day</li>
<li>9,728,325 downloads in the last week</li>
<li>40,614,511 downloads in the last month</li>
<li>33 open issues on GitHub</li>
<li>21 open pull requests on GitHub</li>
</ul>
</li>
</ul>
<p>下载量大于 commander!这个模块只做一件事情：参数选项解析。</p>
<blockquote>
<p>Do one thing and do it well.典型的 linux 风格模块</p>
</blockquote>
<h3>yargs</h3>
<ul>
<li><a href="https://github.com/yargs/yargs">代码地址</a></li>
<li><a href="https://www.npmjs.com/package/yargs">npm 模块</a></li>
<li><a href="http://yargs.js.org/">官网</a></li>
<li>Stats
<ul>
<li>1,411,333 downloads in the last day</li>
<li>7,446,203 downloads in the last week</li>
<li>31,106,735 downloads in the last month</li>
<li>110 open issues on GitHub</li>
<li>2 open pull requests on GitHub</li>
</ul>
</li>
</ul>
<p>如果想创建比较复杂的命令行工具（CLI Tools），可以使用 yargs 来助你一臂之力。</p>
<p><a href="http://yargs.js.org/2016/02/13/yargs-4.html">yargs 从 4.0 开始做了比较细的模块拆分。</a></p>
<h3>参考资料</h3>
<ul>
<li><a href="https://blog.yiminghe.me/2013/09/30/commander-incompatible-with-windows/">https://blog.yiminghe.me/2013/09/30/commander-incompatible-with-windows/</a></li>
</ul>
</article>
          </div>
        </div>
      </div>
    </div>
  </div>


</body><div></div></html>
